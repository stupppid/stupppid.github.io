{"version":3,"sources":["node_modules/oldtvdemo/bell.js","pages/oldTV/index.js"],"names":["module","exports","bell","Bell","id","overTime","reverse","console","log","start"],"mappings":"AAAA;AACA;AACA,ACFA;ADGA;AACA;AACA;AACA,ACJAA,MAAM,CAACC,OAAP,GAAiB,YAAY;ADK7B,ACJE,MAAIC,IAAI,GAAG,IAAIC,kBAAJ,CAAS;ADKtB,ACLwBC,IAAAA,EAAE,EAAE,MAAN;ADMtB,ACNoCC,IAAAA,QAAQ,EAAE,CAAxB;ADOtB,ACPiDC,IAAAA,OAAO,EAAE;ADQ1D,ACRsB,GAAT,EAAqD,YAAY;ADS9E,ACRIC,IAAAA,OAAO,CAACC,GAAR,CAAY,qGAAZ;ADSJ,ACRG,GAFU,CAAX;ADWF,ACREN,EAAAA,IAAI,CAACO,KAAL;ADSF,ACRC,CALD;ADcA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"oldTV.9016d831.js","sourceRoot":"..","sourcesContent":["\t'use strict';    \r\n\tvar Bell = function (options,callback) {\r\n        this.callback = callback;\r\n        this.id = options.id;\r\n        this.overTime = (options.overTime>9 || options.overTime<1)?9000:options.overTime*1000 || 9000;   //超时的时间\r\n        this.reverse = options.reverse||false;\r\n        this.x = options.startTime||1;  //起始时间\r\n        this.tick = options.tick || 40; //帧数\r\n        this.leftTime = this.overTime;\r\n        this.x = 100;\r\n        this.y = 60;\r\n        this.radius = 47;\r\n        this.isover = true;\r\n        this.init();\r\n    }\r\n    Bell.prototype={\r\n        init: function (){\r\n            let _this = this;\r\n            let p = Math.random();\r\n            document.getElementById(this.id).innerHTML = \"\" +\r\n                \"<canvas id=\\\"bell\" + p + '\\\"' +\r\n                \"width=\\\"200px\\\" height=\\\"120px\\\" style=\\\"border: solid gray 1px;\\\">\" +\r\n                \"</canvas>\" +\r\n                \"<audio id='audio' autoplay muted loop>\" +\r\n                \"<source src=\\\"\\.\\/bell.wav\\\" type=\\\"audio/ogg\\\">\" +\r\n                \"老电视声音无法在该浏览器播放\" +\r\n                \"</audio>\";\r\n            this.el = document.getElementById(\"bell\" + p);\r\n            this.audio = document.getElementById('audio')\r\n            this.ctx = this.el.getContext(\"2d\");\r\n            document.getElementById(this.id).addEventListener('touchstart',function (e) {\r\n                if(_this.isover){\r\n                    e.preventDefault();\r\n                    _this.start();\r\n                }\r\n            })\r\n            this.el.addEventListener('click',function (e) {\r\n                if(_this.isover){\r\n                    e.preventDefault();\r\n                    _this.start();\r\n                }\r\n            })\r\n            _this.drawBell();\r\n            _this.drawNumber(this.ctx,0);\r\n        },\r\n        start(){\r\n            let _this = this;\r\n            _this.audio.muted = null;\r\n            _this.isover = false;\r\n            let drawInterval = _this.drawInterval||(1000/_this.tick);\r\n            _this.startTime = new Date();\r\n            _this.intervalHandler = setInterval(function () {\r\n                _this.onTimer();\r\n            },drawInterval)\r\n        },\r\n        onTimer(){\r\n            let _this = this;\r\n\r\n            let t = new Date() - _this.startTime;\r\n            _this.leftTime = t;\r\n            if(t > _this.overTime){\r\n                clearInterval(_this.intervalHandler);\r\n                _this.audio.muted = \"muted\";\r\n                _this.isover = true;\r\n                _this.callback();\r\n            }\r\n\r\n            _this.drawBell();\r\n            let tmpT;\r\n            if(_this.reverse){\r\n                tmpT = Math.ceil((_this.overTime - t)/1000) ;\r\n            }else{\r\n                tmpT = Math.floor((t)/1000) ;\r\n            }\r\n            _this.drawNumber(this.ctx,tmpT);\r\n            _this.preSecond = tmpT;\r\n        },\r\n        drawBell(){\r\n            let ctx = this.ctx;\r\n            //背景渐变色\r\n            this.drawMask(ctx);\r\n            //旋转蒙版弄黑\r\n            this.drawBlackMask(ctx)\r\n            //圆形边框\r\n            this.drawBorder(ctx)\r\n            //黑色的十字线\r\n            this.drawLines(ctx)\r\n        },\r\n        drawNumber(ctx,str){\r\n            ctx.beginPath();\r\n            ctx.font=\"100px Arial\";\r\n            ctx.fillStyle=\"black\"\r\n            ctx.fillText(str,this.x - 27,this.y+36);\r\n        },\r\n        drawMask(ctx){\r\n            let grd=ctx.createRadialGradient(this.x,this.y,0,this.x,this.y,this.radius*2.5 *(.9+.1* Math.random()));\r\n            grd.addColorStop(0,\"#bbb\");\r\n            grd.addColorStop(.4,\"#999\");\r\n            grd.addColorStop(.7,\"#555\");\r\n            grd.addColorStop(1,\"black\");\r\n            ctx.fillStyle=grd;\r\n            ctx.fillRect(0,0,200,120);\r\n        },\r\n        drawBlackMask(ctx){\r\n            ctx.beginPath();\r\n            ctx.fillStyle = \"rgba(0,0,0,.5)\";\r\n            let movePercentage = (this.leftTime %1000)/1000;\r\n            ctx.moveTo(this.x,this.y);\r\n            ctx.lineTo(this.x*2,this.y);\r\n            ctx.arc(this.x,this.y,Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)),0,movePercentage*Math.PI*2)\r\n            ctx.fill();\r\n        },\r\n        drawLines(ctx){\r\n            ctx.beginPath();\r\n            ctx.lineWidth=1;\r\n            ctx.strokeStyle=\"black\"\r\n            ctx.moveTo(this.x,0);\r\n            ctx.lineTo(this.x,this.y*2);\r\n            ctx.moveTo(0,this.y);\r\n            ctx.lineTo(this.x*2,this.y);\r\n            ctx.stroke()\r\n        },\r\n        drawBorder(ctx){\r\n            ctx.beginPath();\r\n            ctx.lineWidth = 1;\r\n            ctx.strokeStyle=\"#bbb\";\r\n            ctx.arc(this.x,this.y,this.radius+1,0,2*Math.PI);\r\n            ctx.arc(this.x,this.y,this.radius+12,0,2*Math.PI);\r\n            ctx.stroke();\r\n        }\r\n    }\r\n\t\r\n\tmodule.exports = Bell;\r\n","import Bell from 'oldtvdemo'\r\n\r\nmodule.exports = function () {\r\n  let bell = new Bell({ id: 'bell', overTime: 9, reverse: true }, function () {\r\n    console.log('time over, if you want to test again, you can click on the screen or run `bell.start()` on console.')\r\n  })\r\n  bell.start()\r\n}\r\n"]}